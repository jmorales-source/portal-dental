<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Portal Cl√≠nico Inveasyble</title>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(135deg, #4a017d, #f4136b, #349980);
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}
.container {
  background: #ffffff;
  width: 95%;
  max-width: 620px;
  padding: 35px;
  border-radius: 18px;
  box-shadow: 0 25px 60px rgba(0,0,0,0.3);
  margin-top: 50px;
}
.logo {
  width: 100%;
  height: 180px;
  border-radius: 16px;
  margin-bottom: 25px;
  background-image: url('https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/eb490604fd29990b9904b81d3148c1de2664798a/Inveasyble2.png');
  background-size: contain;
  background-position: center center;
  background-repeat: no-repeat;
}
h2 {
  text-align: center;
  color: #0f2027;
  margin-bottom: 25px;
}
input {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 15px;
  margin-bottom: 15px;
}
.ejemplo {
  font-size: 12px;
  color: #9aa4ad;
  margin-top: 6px;
  margin-bottom: 20px;
  font-style: italic;
}
button {
  width: 100%;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #2c5364;
  color: white;
  font-size: 15px;
  cursor: pointer;
  margin-bottom: 20px;
}
button:hover {
  background: #203a43;
}
.caso {
  background: #f4f9fb;
  padding: 16px;
  border-radius: 12px;
  margin-bottom: 15px;
  border-left: 5px solid #2c5364;
}
.label {
  font-weight: bold;
  color: #203a43;
}
.mensaje {
  text-align: center;
  font-weight: 500;
  color: #444;
  margin-top: 15px;
}
.links-externos {
  margin-top: 35px;
  text-align: center;
}
.links-externos a {
  display: block;
  margin: 8px 0;
  text-decoration: none;
  color: white;
  font-size: 14px;
}
.links-externos a:hover {
  text-decoration: underline;
}
.materiales-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #00c6ff;
  color: #0f2027;
  padding: 12px 18px;
  border-radius: 30px;
  font-weight: bold;
  text-decoration: none;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  transition: 0.3s;
}
.materiales-btn:hover {
  background: #ffffff;
}
.footer {
  text-align: center;
  margin-top: auto;
  font-size: 14px;
  color: #fff;
  padding: 20px;
  background: #203a43;
  width: 100%;
}
</style>
</head>

<body>

<div class="container">
  <div class="logo"></div>
  <h2>Portal Cl√≠nico Inveasyble</h2>

  <input type="text" id="doctorInput" placeholder="Ingrese su nombre completo + ID Unico">
  <div class="ejemplo">
    Ejemplo: Maria Lopez 1234 (sin tildes y espacio)
  </div>

  <button onclick="buscarCasos()">Consultar</button>

  <div id="resultados"></div>
</div>

<div class="links-externos">
  <a href="https://inveasyble.com/enviar-caso/" target="_blank">üìÑ Formulario de Env√≠o de Caso</a>
  <a href="https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/72232886313b7c8e29be92cb21a3eb346c4ddb6b/T%C3%89RMINOS%20Y%20CONDICIONES%20INVEASYBLE.pdf" target="_blank">üìú T√©rminos y Condiciones</a>
  <a href="https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/72232886313b7c8e29be92cb21a3eb346c4ddb6b/Contrato%20por%20servicios%20de%20ortodoncia%20con%20alineadores.pdf" target="_blank">üìù Contrato de Servicios</a>
  <a href="https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/72232886313b7c8e29be92cb21a3eb346c4ddb6b/Calculo%20de%20Alineadores.xlsx" target="_blank">üìÖ Calendario de Alineadores</a>
  <a href="https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/72232886313b7c8e29be92cb21a3eb346c4ddb6b/Paquetes.jpeg" target="_blank">üìä Ver Planes</a>
  <a href="https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/72232886313b7c8e29be92cb21a3eb346c4ddb6b/Flujo%20de%20trabajo.jpeg" target="_blank">üîÑ Flujo de Trabajo</a>
</div>

<a class="materiales-btn" href="https://raw.githubusercontent.com/jmorales-source/inveasyble-website-assets/72232886313b7c8e29be92cb21a3eb346c4ddb6b/Material.rar" target="_blank">
üì¶ Materiales Mercadeo
</a>

<footer class="footer">
Todos los derechos reservados | Propiedad de Inveasyble | Created by Joseph Morales
</footer>

<script>

const apiURL = "https://script.google.com/macros/s/AKfycbz2IivBhf0ybWk2XfDeQuO628DKrc6s2YaaGZshn_tZ5J3URdejHlo98W-ofN8rFe6g/exec";

let casosGuardados = [];

function formatearFecha(fecha) {
  if (!fecha) return "";
  const f = new Date(fecha);
  return f.toLocaleDateString("es-CR");
}

async function buscarCasos() {

  const doctorInput = document.getElementById("doctorInput").value.trim();
  const resultadosDiv = document.getElementById("resultados");

  if (doctorInput === "") {
    resultadosDiv.innerHTML = "<div class='mensaje'>Ingrese datos correctamente.</div>";
    return;
  }

  resultadosDiv.innerHTML = "<div class='mensaje'>Consultando...</div>";

  try {

    const response = await fetch(`${apiURL}?doctor=${encodeURIComponent(doctorInput)}`);
    const data = await response.json();

    if (!data.length) {
      resultadosDiv.innerHTML = `
        <div class='mensaje'>
          Ingrese datos correctamente.<br><br>
          Si no posee usuario, solicitar acceso al correo:<br>
          <strong>info@inveasyble.com</strong>
        </div>
      `;
      return;
    }

    casosGuardados = data;

    let buscador = `
      <input type="text"
             id="buscadorPaciente"
             placeholder="Buscar paciente..."
             onkeyup="filtrarPacientes()">
    `;

    resultadosDiv.innerHTML = buscador;
    mostrarCasos(casosGuardados);

  } catch (error) {

    resultadosDiv.innerHTML = `
      <div class='mensaje'>
        Error al conectar con el servidor.<br>
        Intente nuevamente o contacte a <strong>info@inveasyble.com</strong>
      </div>
    `;
    console.error(error);
  }
}

function mostrarCasos(lista) {

  const resultadosDiv = document.getElementById("resultados");
  let html = resultadosDiv.innerHTML;

  lista.forEach(item => {
    html += `
      <div class="caso">
        <div><span class="label">Paciente:</span> ${item.paciente || ""}</div>
        <div><span class="label">Fecha de entrega:</span> ${formatearFecha(item.fechaEntrega)}</div>
        <div><span class="label">Cantidad de alineadores U/L:</span> ${item.cantidadAlineadores || ""}</div>
        <div><span class="label">Plan:</span> ${item.planes || ""}</div>
        <div><span class="label">Estatus del caso:</span> ${item.estatus || ""}</div>
      </div>
    `;
  });

  resultadosDiv.innerHTML = html;
}

function filtrarPacientes() {

  const texto = document.getElementById("buscadorPaciente").value.toLowerCase();

  const filtrados = casosGuardados.filter(caso =>
    caso.paciente.toLowerCase().includes(texto)
  );

  const buscadorHTML = document.getElementById("buscadorPaciente").outerHTML;
  document.getElementById("resultados").innerHTML = buscadorHTML;

  mostrarCasos(filtrados);
}

</script>

</body>
</html>


